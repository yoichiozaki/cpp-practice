https://imoz.jp/algorithms/imos_method.html